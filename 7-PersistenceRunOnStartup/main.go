package main

/*

Author: D3Ext
Blog post:

*/

import (
  "fmt"
  "log"
  
  "golang.org/x/sys/windows/registry"
)

func main(){ 
  key, _, err := registry.CreateKey(
    registry.CURRENT_USER,
    "SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Run",
    registry.ALL_ACCESS,
  )

  if err != nil {
    log.Fatal(err)
  }
  defer key.Close()

  err = key.SetStringValue("", "C:\\Windows\\System32\\cmd.exe")
  if err != nil {
    log.Fatal(err)
  }

  fmt.Println("[+] Success!")
}


